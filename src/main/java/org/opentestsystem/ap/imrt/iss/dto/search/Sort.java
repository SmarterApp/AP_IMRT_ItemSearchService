package org.opentestsystem.ap.imrt.iss.dto.search;

import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonIgnore;
import com.fasterxml.jackson.annotation.JsonProperty;
import org.opentestsystem.ap.imrt.iss.util.Preconditions;

/**
 * Allows sorting by a single property in the search
 */
public class Sort {
    public enum Direction {
        @JsonProperty("asc")
        ASC,
        @JsonProperty("desc")
        DESC,
        @JsonProperty("idFilterValues")
        ITEM_ID_ORDER
    }

    private final SearchProperty property;
    private final Direction direction;

    @JsonCreator
    public Sort(@JsonProperty("property") final String property,
                @JsonProperty("direction") final Direction direction) {
        this.property = SearchProperty.findSearchProperty(Preconditions.checkNotNull(property))
                .orElseThrow(() -> new IllegalArgumentException("Do not recognize sort property " + property));
        this.direction = Preconditions.checkNotNull(direction);
    }

    /**
     * @return {@link SearchProperty} to sort by
     */
    @JsonIgnore
    public SearchProperty getSearchProperty() {
        return property;
    }

    /**
     * @return the string property for the sort
     */
    public String getProperty() {
        return property.getProperty();
    }

    /**
     * @return sort direction
     */
    public Direction getDirection() {
        return direction;
    }

    @Override
    public String toString() {
        return String.format("Sort{property='%s', direction=%s}",
                property,
                direction);
    }
}
