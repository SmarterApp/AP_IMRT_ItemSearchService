package org.opentestsystem.ap.imrt.iss.dto;

import org.opentestsystem.ap.imrt.common.model.ImrtItem;

import java.util.List;
import java.util.stream.Collectors;

/**
 * Maps a {@link ImrtItem} to an {@link ItemDto}
 */
public class ItemDtoMapper extends DtoMapper<ImrtItem, ItemDto> {
    private final StandardIdDtoMapper standardIdDtoMapper;

    public ItemDtoMapper(final StandardIdDtoMapper standardIdDtoMapper) {
        this.standardIdDtoMapper = standardIdDtoMapper;
    }

    @Override
    public ItemDto map(final ImrtItem domainObject) {
        ItemDto.ItemDtoBuilder builder = new ItemDto.ItemDtoBuilder()
                .withDepthOfKnowledge(domainObject.getDepthOfKnowledge())
                .withGrade(domainObject.getGrade())
                .withId(domainObject.getId())
                .withCreatedAt(domainObject.getItemCreatedAt())
                .withCreatedBy(domainObject.getItemCreatedBy())
                .withItemType(domainObject.getItemType())
                .withSubject(domainObject.getSubject())
                .withWorkflowStatus(domainObject.getWorkflowStatus());

        List<StandardIdDto> standardIdDtos = domainObject.getStandardIds().stream()
                .map(standardIdDtoMapper::map)
                .collect(Collectors.toList());

        return builder.withStandardIds(standardIdDtos).build();
    }
}
